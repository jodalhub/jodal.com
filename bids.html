<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“‹ ì…ì°°ê³µê³  ë¦¬ìŠ¤íŠ¸ - ì¡°ë‹¬ë‹·ì»´</title>
  <script src="auth.js"></script>
  
<style>
  body { font-family: sans-serif; padding: 30px; max-width: 1000px; margin: auto; }
  .topbar { display: flex; justify-content: space-between; align-items: center; }
  button { padding: 8px 12px; font-size: 14px; cursor: pointer; }
</style>

</head>
<body>
  <div class="topbar">
    <h1>ğŸ“‹ ì…ì°°ê³µê³  ë¦¬ìŠ¤íŠ¸</h1>
    <button onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
  </div>
  <p>ğŸ“‹ ì…ì°°ê³µê³  ë¦¬ìŠ¤íŠ¸ ë³¸ë¬¸ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
  
<script>
function logout() {
  localStorage.removeItem("loggedInUser");
  alert("ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.");
  setTimeout(() => {
    window.location.href = "login.html";
  }, 500);
}
</script>

</body>
</html>
=======
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì…ì°°ê³µê³  ë¦¬ìŠ¤íŠ¸ - ì¡°ë‹¬ë‹·ì»´</title>
  <style>
    body { font-family: sans-serif; padding: 40px; max-width: 1200px; margin: auto; }
    h1 { font-size: 26px; margin-bottom: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    .search-sort { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    input[type="text"] { padding: 8px; width: 300px; }
    select { padding: 8px; }
    button {
      padding: 6px 12px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover { background-color: #218838; }
    .modal {
      display: none; position: fixed; top: 20%; left: 50%; transform: translate(-50%, -20%);
      background: white; padding: 20px; border: 1px solid #ccc; box-shadow: 0 2px 10px rgba(0,0,0,0.3);
      z-index: 1000; width: 400px;
    }
    .modal h3 { margin-top: 0; }
    .modal-close { margin-top: 20px; text-align: right; }
    .checkmark { color: green; font-size: 18px; margin-left: 4px; }
  </style>
</head>
<body>
  <h1>ğŸ“‹ ì…ì°°ê³µê³  ë¦¬ìŠ¤íŠ¸</h1>

  <div class="search-sort">
    <input type="text" id="searchInput" placeholder="ê³µê³ ëª…, ì§€ì—­, ê³µê³ ë²ˆí˜¸ ê²€ìƒ‰" oninput="renderTable()" />
    <label>ì •ë ¬:
      <select id="sortSelect" onchange="renderTable()">
        <option value="ë§ˆê°ì¼">ë§ˆê°ì¼ ì˜¤ë¦„ì°¨ìˆœ</option>
        <option value="ì§€ì—­">ì§€ì—­ ê°€ë‚˜ë‹¤ìˆœ</option>
      </select>
    </label>
  </div>

  <table>
    <thead>
      <tr>
        <th>ì…ì°°ì‚¬ì´íŠ¸</th>
        <th>ì§€ì—­</th>
        <th>ê³µê³ ë²ˆí˜¸</th>
        <th>ê³µê³ ëª…</th>
        <th>ê¸°ì´ˆê¸ˆì•¡</th>
        <th>ë‚™ì°°í•˜í•œìœ¨</th>
        <th>ë§ˆê°ì¼</th>
        <th>íˆ¬ì°°ì‹œê°„</th>
        <th>ê³„ì‚°</th>
      </tr>
    </thead>
    <tbody id="bidsTableBody"></tbody>
  </table>

  <!-- ìƒì„¸ ì •ë³´ íŒì—… -->
  <div class="modal" id="detailModal">
    <h3 id="modalTitle">ê³µê³  ìƒì„¸</h3>
    <div id="modalContent"></div>
    <div class="modal-close">
      <button onclick="closeModal()">ë‹«ê¸°</button>
    </div>
  </div>

  <script>
    let bidData = [];

    fetch('bids.json')
      .then(res => res.json())
      .then(data => {
        bidData = data;
        renderTable();
      });

    function renderTable() {
      const tbody = document.getElementById('bidsTableBody');
      const search = document.getElementById('searchInput').value.trim().toLowerCase();
      const sort = document.getElementById('sortSelect').value;
      const submittedTitles = JSON.parse(localStorage.getItem("submittedTitles") || "[]");

      let filtered = bidData.filter(bid =>
        bid.ê³µê³ ëª….toLowerCase().includes(search) ||
        bid.ì§€ì—­.toLowerCase().includes(search) ||
        bid.ê³µê³ ë²ˆí˜¸.includes(search)
      );

      // ì •ë ¬
      if (sort === "ë§ˆê°ì¼") {
        filtered.sort((a, b) => new Date(a.ë§ˆê°ì¼) - new Date(b.ë§ˆê°ì¼));
      } else if (sort === "ì§€ì—­") {
        filtered.sort((a, b) => a.ì§€ì—­.localeCompare(b.ì§€ì—­, 'ko'));
      }

      tbody.innerHTML = '';
      filtered.forEach(bid => {
        const isSubmitted = submittedTitles.includes(bid.ê³µê³ ëª…);
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${bid.ì…ì°°ì‚¬ì´íŠ¸}</td>
          <td>${bid.ì§€ì—­}</td>
          <td>${bid.ê³µê³ ë²ˆí˜¸}</td>
          <td><a href="#" onclick="showDetail('${bid.ê³µê³ ëª…}', \`${JSON.stringify(bid).replace(/"/g, '&quot;')}\`)">${bid.ê³µê³ ëª…}</a></td>
          <td>${Number(bid.ê¸°ì´ˆê¸ˆì•¡).toLocaleString()} ì›</td>
          <td>${bid.ë‚™ì°°í•˜í•œìœ¨}%</td>
          <td>${bid.ë§ˆê°ì¼}</td>
          <td>${bid.íˆ¬ì°°ì‹œê°„}</td>
          <td>
            <button onclick="goToCalculator(${bid.ê¸°ì´ˆê¸ˆì•¡}, ${bid.ë‚™ì°°í•˜í•œìœ¨}, '${bid.ê³µê³ ëª….replace(/'/g, "\\'")}', '${bid.ì˜ˆë¹„ê°€ê²©ë²”ìœ„}')">
              ê³„ì‚°
            </button>
            ${isSubmitted ? '<span class="checkmark">âœ”</span>' : ''}
          </td>
        `;
        tbody.appendChild(row);
      });
    }

    function goToCalculator(baseAmount, rate, title, range) {
      sessionStorage.setItem('baseAmount', baseAmount);
      sessionStorage.setItem('rate', rate);
      sessionStorage.setItem('title', title);
      sessionStorage.setItem('range', range);
      window.location.href = 'calculator.html';
    }

    function showDetail(title, dataJson) {
      const bid = JSON.parse(dataJson.replace(/&quot;/g, '"'));
      const modal = document.getElementById('detailModal');
      const content = document.getElementById('modalContent');
      document.getElementById('modalTitle').innerText = title;
      content.innerHTML = `
        <p><strong>ê³µê³ ë²ˆí˜¸:</strong> ${bid.ê³µê³ ë²ˆí˜¸}</p>
        <p><strong>ì…ì°°ì‚¬ì´íŠ¸:</strong> ${bid.ì…ì°°ì‚¬ì´íŠ¸}</p>
        <p><strong>ì§€ì—­:</strong> ${bid.ì§€ì—­}</p>
        <p><strong>ê¸°ì´ˆê¸ˆì•¡:</strong> ${Number(bid.ê¸°ì´ˆê¸ˆì•¡).toLocaleString()} ì›</p>
        <p><strong>ë‚™ì°°í•˜í•œìœ¨:</strong> ${bid.ë‚™ì°°í•˜í•œìœ¨}%</p>
        <p><strong>ì˜ˆë¹„ê°€ê²© ë²”ìœ„:</strong> ${bid.ì˜ˆë¹„ê°€ê²©ë²”ìœ„}</p>
        <p><strong>ë§ˆê°ì¼:</strong> ${bid.ë§ˆê°ì¼} ${bid.íˆ¬ì°°ì‹œê°„}</p>
      `;
      modal.style.display = 'block';
    }

    function closeModal() {
      document.getElementById('detailModal').style.display = 'none';
    }
  </script>
</body>
</html>
